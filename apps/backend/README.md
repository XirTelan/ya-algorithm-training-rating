# Общее

Стек:
  Fastify,
  Swagger,
  Cheerio,
  Mongoose,
  Pino


Апи так же можно посмотреть в свагере (/documentation) при запуске 

![image](https://github.com/user-attachments/assets/45dacad4-948f-4da2-a537-83e3855ce1f5)


```
pnpm rгn i
pnpm run dev
```
# Аутентификация

часть эндпоинтов защищена по принципу `autherization:` header и JWT .  
Так как изначально рейтинг был отдельным приложением на нексте со своим апи, то гуи+бэк использовались чисто изолировано.
Как следствие не было никакого смысла в полноценной системе авторизации и даже рутов.
И так как этом проекту в целом не требуется система пользователей, но всё же требуется защита рутов -  авторизация сделана по упрощенной схеме.
в `env` указываются `SECRET` и `API_KEY`.
1е собственно для подписи/валидации токена. 
2е выступает в роли админ пароля. Как `.htpasswd` только еще и без юзернейма.
Посылаем ключ на `api/auth/login` получаем токен


# Структура

- `controllers`: собственно контроллеры, обработка запросов, отправка ответа
- `models`: модели бд (mongoDb)
- `lib`:  подключение к бд и логика парсера
- `plugins`: конфига к плагинам fastify - свагер, env, логгер
- `routes`: определение  эндпоинты +  схема + контроллер
- `schemas`: схемы эдпоинтов / свагера которые  больше пары строк,  чтобы не держать их напрямую в `routes`  
- `services`: собственно бизнес логика и взаимодействие с бд.
- `tasks`: задачи - обновление контестов

# ENV

## общее

Аутентификация рутов и ключ.
```
SECRET=Для подписи JWT
API_KEY=Для выдачи токена 
```

Порт на котором запустится сервер
```
SERVER_PORT=3000
SERVER_HOST=0.0.0.0
```

## Подключение к бд
```
DATABASE_HOST=
DATABASE_PORT=
MONGO_BACKEND_USERNAME=
MONGO_BACKEND_PASSWORD=
MONGO_BACKEND_DATABASE=

```
сама строка строится как 
```
 `mongodb://${MONGO_BACKEND_USERNAME}:${MONGO_BACKEND_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${MONGO_BACKEND_DATABASE}`;
```


